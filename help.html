<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Help</title>

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>


  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    #input-container {
      margin-bottom: 20px;
      background-color: #ecf0f1;
      padding: 20px;
      display: flex;
      /* Make the input container a flex container */
      gap: 20px;
      /* Add some space between the cards */
      align-items: flex-start;
      /* Align items to the top to handle different heights */
    }

    #csv-container {
      width: 100%;
      height: 420px;
      /* Or whatever height you prefer */
      margin: 10px auto;
      overflow: auto;
      /* Add scrollbars when needed */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 10px;
      display: none;
      /* Initially hidden */
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th,
    td {
      border: 1px solid black;
      padding: 8px;
      text-align: center;
      transition: background-color 0.2s;
    }


    th {
      cursor: pointer;
      background-color: #3498db;
      color: white;
      /* Changed header text color to white */
      position: sticky;
      top: 0;
      z-index: 1;
    }


    th:hover {
      background-color: #0077B3;
      color: white;
    }

    div {
      background-color: rgb(236, 246, 247);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }


    /* BUTTONS */

    /* button */
    .button {
      border: none;
      color: white;
      padding: 20px 34px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      transition-duration: 0.4s;
      cursor: pointer;
    }

    /* button1 */

    .button1 {
      background-color: white;
      color: black;
      border: 2px solid #04AA6D;
      padding: 3px 8px;
    }

    .button1:hover {
      background-color: #04AA6D;
      color: white;
    }

    /* button2 */

    .button2 {
      background-color: white;
      color: black;
      border: 2px solid #008CBA;
      padding: 3px 8px;
    }

    .button2:hover {
      background-color: #008CBA;
      color: white;
    }

    /* button3 */

    .button3 {
      background-color: #f1f4f5;
      color: black;
      border: 1px solid #04AA6D;
      padding: 3px 8px;
      height: 27px;
      width: 65px;
      border-radius: 4px;
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
    }

    .button3:hover {
      background-color: #04AA6D;
      color: white;
    }

    /* button4 */

    .button4 {
      background-color: #f1f4f5;
      color: black;
      border: 1px solid #04AA6D;
      padding: 3px 8px;
      height: 27px;
      width: 120px;
      border-radius: 4px;
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
    }

    .button4:hover {
      background-color: #04AA6D;
      color: white;
    }

    /* open-button */

    .open-button {
      background-color: #008CBA;
      color: rgb(255, 255, 255);
      padding: 5px 10px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      margin-bottom: 10px;
      border-radius: 0px;
      height: 27px;
      width: 90px;
    }

    .open-button:hover {
      background-color: #0077B3;
    }

    /* save-button */

    .save-button {
      background-color: #2dc806;
      color: white;
      padding: 5px 10px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      margin-bottom: 10px;
      border-radius: 0px;
      height: 27px;
      width: 70px;
    }

    .save-button:hover {
      background-color: #069001;
    }

    /* clear-button */

    .clear-button {
      background-color: #f44336;
      border: none;
      color: white;
      padding: 5px 10px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      margin: 10px 2px;
      cursor: pointer;
      border-radius: 0px;
      height: 27px;
      width: 70px;
    }

    .clear-button:hover {
      background-color: #da190b;
      /* Darker red on hover */

    }

    /* hide-button */

    .hide-button {
      background-color: #a08785;
      border: none;
      color: white;
      padding: 5px 10px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      margin: 10px 2px;
      cursor: pointer;
      border-radius: 0px;
      height: 27px;
      width: 70px;
    }

    .hide-button:hover {
      background-color: #8a5d5a;
    }

    /* reload-button */

    .reload-button {
      background-color: #ffe100;
      color: rgb(0, 0, 0);
      padding: 5px 10px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      margin-bottom: 10px;
      border-radius: 0px;
      height: 27px;
      width: 70px;
    }

    .reload-button:hover {
      background-color: #fff700e0;
    }

    /* invert-button */

    .invert-button {
      background-color: #008CBA;
      color: white;
      padding: 5px 10px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      margin-bottom: 10px;
      border-radius: 0px;
      height: 27px;
      width: 70px;
    }

    .invert-button:hover {
      background-color: #0077B3;

    }

    /* labels */

    .row-label {
      font-size: 1.5em;
      /* Use a valid unit like em, px, rem, etc. */
      color: rgb(148, 19, 96);
    }

    .column-label {
      font-size: 1.5em;
      /* Use a valid unit like em, px, rem, etc. */
      color: rgb(18, 117, 12);
    }

    .zero-label {
      font-size: 1.5em;
      /* Use a valid unit like em, px, rem, etc. */
      color: rgb(34, 19, 148);
    }

    .log2-label {
      font-size: 1.5em;
      /* Use a valid unit like em, px, rem, etc. */
      color: rgb(197, 7, 7);
    }

    /* left TAP */
    .tab {
      Padding-left: 145px;
    }


    .container {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }

    #Plot {
      display: flex;
      justify-content: center;
      align-items: center;
      /* Optional: Set a specific height if needed */
      /* height: 420px; */
    }

    /* Row highlighted */
    .row-highlighted {
      background-color: rgba(173, 216, 230, 0.5);
      /* lightblue με 50% διαφάνεια */
    }

    /* Navigation Bar */
    .navbar {
      background-color: #2c3e50;
      padding: 1rem;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .navbar .nav-links {
      list-style: none;
      display: flex;
      gap: 1rem;
    }

    .navbar .nav-links a {
      text-decoration: none;
      color: white;
      padding: 0.5rem 1rem;
      background-color: #34495e;
      border-radius: 5px;
      transition: background-color 0.3s;
    }

    .navbar .nav-links a.active {
      background-color: #e74c3c;
      /* Example: Red for active */
      color: white;
    }


    .navbar .nav-links a:hover {
      background-color: #1abc9c;
    }

    /* Highlighting */
    .highlight {
      background-color: rgba(173, 216, 230, 0.5) !important;
      /* lightblue με 50% διαφάνεια */
    }

    /* Highlighted Header */
    .highlighted-header {
      background-color: #0077B3 !important;
      color: white !important;
    }


    /* Main Content */
    .main {
      flex: 1;
      padding: 1rem;
      background-color: #ecf0f1;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .card {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .field {
      background: white;
      padding: 1rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: left;
      flex: 1;
      /* Distribute available space equally between the cards */
    }


    .boxPlot {
      background: rgb(200, 237, 202);
      padding: 1.0rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      font-size: 4;
      text-align: center;
    }

    .barchart {
      background: rgb(241, 237, 237);
      padding: 1.0rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      font-size: 4;
      text-align: center;
    }

    .piechart {
      background: rgb(ecf0f1);
      padding: 1.0rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      font-size: 4;
      text-align: center;
    }

    .cardmap {
      background: rgb(224, 218, 218);
      padding: 1.0rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      font-size: 4;
      text-align: center;
    }

    .activemap {
      background: rgb(200, 195, 195);
      padding: 1.0rem;
      border-radius: 0px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      font-size: 4;
      text-align: center;
    }


    /* Footer */
    .footer {
      background-color: #34495e;
      color: white;
      text-align: center;
      padding: 1rem 0;
    }
  </style>

</head>


<body>

  <!-- Navigation Bar -->

  <nav class="navbar">
    <h1>Clinical Dashboard</h1>
    <ul class="nav-links">
      <li><a href="main.html" id="mainTabLink" target="_blank">Main</a></li>
      <li><a href="combine.html" id="combineTabLink" target="_blank">Combine</a></li>
      <li><a href="create.html" id="createTabLink" target="_blank">Create</a></li>
      <li><a href="schedule.html" id="scheduleTabLink" target="_blank">Schedule</a></li>
      <li><a href="help.html" class="active">Help</a></li>
    </ul>
  </nav>

  <br>

  <!-- Open CSV -->

  <button class="open-button" id="openFileButton">Open CSV</button>

  <!--Space-->
  &#8202;&#8202;

  <input type="text" id="selectedFileName" placeholder="Select file to open" readonly
    style="margin-left: 2px; border: 1px solid #ccc; padding: 5px;">
  <input type="file" id="csvFileInput" accept=".csv" style="display: none;">

  <!--Space-->
  &#8202;&#8202;

  <!-- Save Button -->
  <button class="save-button" id="saveTableButton">Save</button>

  <!--Space-->
  &#8202;

  <!-- Clear Button -->
  <button class="clear-button" onclick="clearTable()">Clear</button>

  <!--Space-->
  &#8202;

  <!-- Hide Button -->
  <button class="hide-button" onclick="hideTable()">Hide</button>

  <!--Space-->
  &#8202;

  <!-- Reload Button -->
  <button class="reload-button" onclick="reloadTable()">Reload</button>

  <!--Space-->
  &#8202;

  <!-- Invert Rows to Columns Button -->
  <button class="invert-button" onclick="invertRowsColumns()">Invert</button>

  <!--Space-->
  &#8202;

  <!-- Sort button by zero column-->
  <button class="button2" onclick="sortTableByColumn0()">Sort by 0</button>

  <br><br>


  <!--Columns and Rows Textfields container-->

  <div id="input-container">

    <!-- * topCard1 * Rows handling container-->

    <div id="topCard1" class="field">

      <label for="row-label" class="row-label"><b>Row:</b>
        </font>
      </label>

      <br><br>

      <!-- Rows - Textbox to show clicked row name -->
      <label for="columnName">
        <font size=4 color="#34495e"><b>Row:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#8202;&#8202;</b></font>
      </label>
      <input type="text" id="row" name="row" placeholder="None Selected" readonly
        style="margin-left: 16px; width: 140px; border: 1px solid #ccc; padding: 5px;">

      <!--Space-->
      &#8202;

      <!-- Rows - Delete and Undo Buttons -->
      <button class="button3" id="deleteRowBtn" onclick="deleteRow()">Delete</button>

      <br><br>
      <!-- Row - Size -->
      <label for="rowSize">
        <font size=3 color="#34495e"><b>Row Size:</b></font>
      </label>
      <input type="text" id="rowsize" name="rowsize" placeholder="No CSV Data" readonly
        style="margin-left: 16px; color: red; width: 140px; border: 1px solid #ccc; padding: 5px;">

      <!--Space-->
      &#8202;

      <button class="button3" id="undoBtnRow" onclick="undoDeleteRow()">Undo</button>
    </div>

    <!-- * topCard2 * Columns handling container-->

    <div id="topCard2" class="field">

      <label for="column-label" class="column-label"><b>Column:</b>
        </font>
      </label>

      <br><br>

      <!-- Columns - Textbox to show clicked header name -->
      <label for="columnName">
        <font size=4 color="#34495e"><b>Column:</b></font>
      </label>
      <input type="text" id="columnName" placeholder="None Selected" readonly
        style="margin-left: 15px; width: 140px; border: 1px solid #ccc; padding: 5px;">

      <!--Space-->
      &#8202;

      <!-- Columns - Delete and Undo Buttons -->
      <button class="button3" id="deleteColumnBtn" onclick="deleteColumn()">Delete</button>

      <br><br>
      <!-- Column - Size -->
      <label for="colSize">
        <font size=3 color="#34495e"><b>Col Size:&nbsp;</b></font>
      </label>
      <input type="text" id="colsize" name="colsize" placeholder="No CSV Data" readonly
        style="margin-left: 16px; color: red; width: 140px; border: 1px solid #ccc; padding: 5px;">

      <!--Space-->
      &#8202;

      <button class="button3" id="undoBtn" onclick="undoDelete()">Undo</button>
    </div>

    <!-- * topCard3 * Zero handling container-->

    <div id="topCard3" class="field">

      <label for="zero-value" class="zero-label"><b>Zero-Value:</b>
        </font>
      </label>

      <br><br>

      <label for="zeroValue">
        <font size=3 color="#34495e"><b>Zero-Value cells:&nbsp;</b></font>
      </label>

      &nbsp;&#8202;

      <button class="button4" onclick="removeZeroRows()">Remove Rows</button><br><br>
      <span class="tab">
        <button class="button4" onclick="undoRemove()">Undo Remove</button>
      </span>
    </div>

    <!-- * topCard4 * Log2 handling container-->

    <div id="topCard4" class="field">

      <label for="log2-label" class="log2-label"><b>Log2:</b>
        </font>
      </label>

      <br><br>

      <label for="log2Conv">
        <font size=3 color="#34495e"><b>Log2 Conversion:&nbsp;</b></font>
      </label>

      <button class="button4" onclick="calculateLog2()">Log2</button><br><br>

      <span class="tab">
        <button class="button4" onclick="undoLog2()">Undo Log2</button>
      </span>
    </div>

  </div>

  <!-- Table-->

  <!-- Table container -->

  <div id="csv-container">
    <table id="csvTable"></table>
  </div>

  <br>


  <!--Blue bar-->

  <div class="boxPlot">
    <div id="Plot"></div>
  </div>

  <br>

  <!-- Main Content -->

  <main class="main">

    <!--Card 1-->
    <!--BoxPlot Handlers-->
    <div id="card1" class="cardmap">
      <font size=4 color="#9900FF"><b>Box Plot</b></font><br><br>
      <button id="showboxbutt" class="button1"
        onclick="setAlltoCardMap(); changeCardColor('showboxbutt', 'activemap'); updatePlot(); scrollToMainPlot();">Show</button>
      <button id="hideboxbutt" class="button2" onclick="setAlltoCardMap(); clearBoxPlot()">Hide</button><br>
      <div id="CanvasBoxPlot"></div>
    </div>


    <!--Card 2-->
    <!--HeatMap Handlers-->
    <div id="card2" class="cardmap">
      <font size=4 color="#9900FF"><b>Heatmap</b></font><br><br>
      <button id="showheatbutt" class="button1"
        onclick="setAlltoCardMap(); changeCardColor('showheatbutt', 'activemap'); generateHeatmap(); scrollToMainPlot();">Show</button>
      <button id="hideheatbutt" class="button2" onclick="setAlltoCardMap(); clearHeatmap()">Hide</button><br>
      <div id="heatmapPlot"></div>
    </div>


    <!--Card 3-->
    <!-- BarChart Handlers-->
    <div id="card3" class="cardmap">
      <font size=4 color="#9900FF"><b>Bar Chart</b></font><br><br>
      <button id="showbarbutt" class="button1"
        onclick="setAlltoCardMap(); changeCardColor('showbarbutt', 'activemap'); generateChart(); scrollToMainPlot();">Show</button>
      <button id="hidebarbutt" class="button2" onclick="setAlltoCardMap(); clearBarChart()">Hide</button>
      <input type="number" id="yAxisMinBar" placeholder="0"
        style="width: 50px; height: 25px; border: 2px solid #04AA6D; padding: 3px 5px;"><br>
      <div id="myCanvasBar"></div>
    </div>


    <!--Card 4-->
    <!-- Pie Chart Handlers-->
    <div id="card4" class="cardmap">
      <font size=4 color="#9900FF"><b>Pie Chart</b></font><br><br>
      <button id="showpiebutt" class="button1"
        onclick="setAlltoCardMap(); changeCardColor('showpiebutt', 'activemap'); generatePieChart(); scrollToMainPlot();">Show</button>
      <button id="hidepiebutt" class="button2" onclick="setAlltoCardMap(); clearPieChart()">Hide</button><br>
      <div id="pieChartCanvas"></div>
    </div>

    <!--Card 5-->
    <!-- Line Chart Handlers-->
    <div id="card5" class="cardmap">
      <font size=4 color="#9900FF"><b>Line Chart</b></font><br><br>
      <button id="showlinebutt" class="button1"
        onclick="setAlltoCardMap(); changeCardColor('showlinebutt', 'activemap'); generateLineChart(); scrollToMainPlot();">Show</button>
      <button id="hidelinebutt" class="button2" onclick="setAlltoCardMap(); clearLineChart()">Hide</button>
      <input type="number" id="yAxisMin" placeholder="0"
        style="width: 50px; height: 25px; border: 2px solid #04AA6D; padding: 3px 5px;"><br>
      <div id="myLineChart"></div>
    </div>

  </main>

  <!--Table Script Start-->

  <script>
    // Store original Data (Global)
    let originalData = [];

    // Store modified Data (Global)
    let modifiedData = [];

    // Store original data before log2 transformation (for undo)
    let preLog2Data = [];

    // ZERO rows: Store removed rows for undo
    let zeroRowsRemoved = [];

    const selectedFileNameInput = document.getElementById('selectedFileName'); // Get the input element

    // Set selectedFileName to empty on initial load
    selectedFileNameInput.value = '';

    initializeInput('rowsize', 'No CSV Data');
    initializeInput('colsize', 'No CSV Data');


    // Προσθέστε έλεγχο πριν την κλήση της renderTable
    if (modifiedData && modifiedData.length === 0) {
      // Εμφάνιση ενός μηνύματος ή εκτέλεση άλλης λογικής
      document.getElementById('csv-container').innerHTML = "<p>No data to display.</p>";
    } else {
      renderTable();
    }

    // File Reader 

    document.getElementById('openFileButton').addEventListener('click', function () {
      document.getElementById('csvFileInput').click(); // Trigger the file input
    });

    let lastLoadedCsvContent = null;
    let lastLoadedFileName = null;


    document.getElementById('csvFileInput').addEventListener('change', function (event) {
      const file = event.target.files[0];

      document.getElementById('csv-container').style.display = 'block';
      document.querySelector('.hide-button').textContent = 'Hide';

      if (file) {
        lastLoadedFileName = file.name;
        document.getElementById('selectedFileName').value = lastLoadedFileName;

        const reader = new FileReader();
        reader.onload = function (e) {
          lastLoadedCsvContent = e.target.result;
          const csv = lastLoadedCsvContent;
          Papa.parse(csv, {
            complete: function (results) {
              originalData = results.data;
              // Filter out rows where all cells are empty after trimming whitespace
              modifiedData = originalData.filter(row => row.some(cell => cell.trim() !== ''));

              // Ensure these elements exist before calling initializeInput
              if (document.getElementById('yAxisMinBar')) {
                initializeInput('yAxisMinBar', '0');
              } else {
                console.warn("Element with ID 'yAxisMinBar' not found.");
              }
              if (document.getElementById('yAxisMin')) {
                initializeInput('yAxisMin', '0');
              } else {
                console.warn("Element with ID 'yAxisMin' not found.");
              }

              renderTable();
              document.getElementById('csvFileInput').value = '';

              // Scroll to the main plot after rendering the table
              document.getElementById('Plot').scrollIntoView({
                behavior: 'smooth'
              });
            }
          });
        };
        reader.readAsText(file);
      } else {
        if (document.getElementById('selectedFileName').value === '') {
          return;
        }
        document.getElementById('csvFileInput').value = '';
      }
    });

    // Function to initialize Input   

    function initializeInput(inputId, placeholderText) {
      const valInput = document.getElementById(inputId);
      if (valInput) {
        valInput.placeholder = placeholderText;
        valInput.value = ''; // Ensure the value is empty, not the placeholder
      } else {
        console.error(`Element with ID '${inputId}' not found.`);
      }
    }

    // Function to change Cardclass when button clicked

    function changeCardColor(buttonId, classtype) {
      const buttonElement = document.getElementById(buttonId);
      if (buttonElement) {
        const parentDiv = buttonElement.parentNode;
        if (parentDiv) {
          // Remove any existing card-related classes
          parentDiv.classList.remove('cardmap', 'activemap');
          // Add the new class specified by classtype
          parentDiv.classList.add(classtype);
        } else {
          console.error(`Parent node not found for button with ID: ${buttonId}`);
        }
      } else {
        console.error(`Button with ID "${buttonId}" not found.`);
      }
    }


    // Function to set cardmap to all classes

    function setAlltoCardMap() {
      const cardIdList = ["card1", "card2", "card3", "card4", "card5"];
      cardIdList.forEach(cardId => {
        const cardElement = document.getElementById(cardId);
        if (cardElement) {
          // Remove any existing card-related classes
          cardElement.classList.remove('activemap'); // Only remove activemap, keep cardmap if it exists
          cardElement.classList.add('cardmap');
        } else {
          console.warn(`Card element with ID '${cardId}' not found.`);
        }
      });
    }




    // Function renderTable

    function renderTable() {
      const tableContainer = document.getElementById('csv-container');
      tableContainer.innerHTML = '';

      if (!modifiedData || modifiedData.length === 0) {
        tableContainer.innerHTML = "<p>No data to display.</p>";
        return;
      }

      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');

      // Table Header
      const headerRow = document.createElement('tr');
      modifiedData[0].forEach((col, index) => {
        const th = document.createElement('th');
        th.textContent = col;
        th.onclick = () => {
          document.getElementById('columnName').value = col;
          highlightColumn(index);
        };
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);
      table.appendChild(thead);

      // Create table body
      for (let i = 1; i < modifiedData.length; i++) {
        const row = document.createElement('tr');
        row.dataset.rowIndex = i - 1; // Store row index as data attribute
        modifiedData[i].forEach((value, colIndex) => {
          const td = document.createElement('td');
          td.textContent = value;
          row.appendChild(td);
        });
        tbody.appendChild(row);

        // Add click event listener to each row for highlighting
        row.addEventListener('click', function () {
          highlightRow(parseInt(this.dataset.rowIndex));
        });
      }
      table.appendChild(tbody);
      tableContainer.appendChild(table);

      // Update row size display
      document.getElementById('rowsize').value = modifiedData.length;

      // Update col size display
      if (modifiedData.length > 0 && modifiedData[0].length !== undefined) {
        document.getElementById('colsize').value = modifiedData[0].length;
      } else {
        document.getElementById('colsize').value = '0';
      }

      // Re-apply highlight if a column or row was previously selected after re-rendering
      if (highlightedColumnIndex !== -1 && modifiedData[0] && highlightedColumnIndex < modifiedData[0].length) {
        const header = document.querySelector(`table thead tr th:nth-child(${highlightedColumnIndex + 1})`);
        if (header) {
          header.classList.add('highlighted-header');
        }
        document.querySelectorAll(`table tr`).forEach(row => {
          const cell = row.cells[highlightedColumnIndex];
          if (cell) {
            cell.classList.add('highlight');
          }
        });
      } else if (highlightedRowIndex !== -1) {
        const selectedRow = document.querySelector(`table tbody tr[data-row-index="${highlightedRowIndex}"]`);
        if (selectedRow) {
          selectedRow.classList.add('row-highlighted');
        }
      }
    }

    // Invert CSV Button

    function invertRowsColumns() {
      if (!modifiedData || modifiedData.length === 0 || modifiedData[0].length === 0) {
        alert("Please load a CSV file first.");
        return;
      }

      let invertedData = [];
      let numRows = modifiedData.length;
      let numCols = modifiedData[0].length;

      for (let j = 0; j < numCols; j++) {
        let newRow = [];
        for (let i = 0; i < numRows; i++) {
          newRow.push(modifiedData[i][j]);
        }
        invertedData.push(newRow);
      }

      modifiedData = invertedData;
      renderTable();

      // Scroll to the main plot after inverting the table
      document.getElementById('Plot').scrollIntoView({
        behavior: 'smooth'
      });
    }


    // Save CSV Button
    const saveTableButton = document.getElementById('saveTableButton');
    saveTableButton.addEventListener('click', () => {
      const selectedTable = document.getElementById('csv-container');
      const rows = selectedTable.querySelectorAll('tr');
      let csvContent = ""; // Removed "data:text/csv;charset=utf-8,"

      rows.forEach(row => {
        const rowData = [];
        const cells = row.querySelectorAll('td, th');
        cells.forEach(cell => {
          rowData.push(cell.textContent);
        });
        csvContent += rowData.join(',') + '\r\n';
      });

      // Directly save if lastLoadedFileName is available, otherwise prompt for download
      if (lastLoadedFileName) {
        // Create a Blob with the CSV data
        const blob = new Blob([csvContent], {
          type: 'text/csv;charset=utf-8;'
        });

        // Create a temporary link element
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = lastLoadedFileName; // Use the original filename

        // Programmatically trigger the download
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } else {
        // Fallback to downloading if no original file was loaded
        const encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
        const link = document.createElement('a');
        link.setAttribute('href', encodedUri);
        link.setAttribute('download', 'modified_table.csv');
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    });

    // Function to sort the table by the first column (column 0)

    function sortTableByColumn0() {
      if (!modifiedData || modifiedData.length <= 1) {
        alert("Please load a CSV file first.");
        return;
      }

      const headerRow = modifiedData[0];
      const dataRows = modifiedData.slice(1);

      dataRows.sort((a, b) => {
        const valueA = a[0];
        const valueB = b[0];

        if (typeof valueA === 'string' && typeof valueB === 'string') {
          return valueA.localeCompare(valueB);
        } else {
          return valueA - valueB;
        }
      });

      modifiedData = [headerRow, ...dataRows];
      renderTable();
    }


    // function to Zero Rows deletion

    function removeZeroRows() {
      if (!modifiedData || modifiedData.length <= 1) {
        alert("Please load a CSV file first.");
        return;
      }

      zeroRowsRemoved = []; // Clear previous removed rows

      const headerRow = modifiedData[0];
      const numericColumns = headerRow.map((col, index) => {
        let isNumeric = true;
        for (let i = 1; i < modifiedData.length; i++) {
          if (isNaN(parseFloat(modifiedData[i][index]))) {
            isNumeric = false;
            break;
          }
        }
        return isNumeric ? index : -1;
      }).filter(index => index !== -1);

      let newModifiedData = [modifiedData[0]]; // Keep header row

      for (let i = 1; i < modifiedData.length; i++) {
        let hasZero = false;
        for (let colIndex of numericColumns) {
          if (parseFloat(modifiedData[i][colIndex]) === 0) {
            hasZero = true;
            break;
          }
        }
        if (!hasZero) {
          newModifiedData.push(modifiedData[i]);
        } else {
          zeroRowsRemoved.push({
            index: i,
            data: modifiedData[i]
          });
        }
      }

      modifiedData = newModifiedData;
      renderTable();
    }


    // function to undo Zero Rows deletion

    function undoRemove() {
      if (zeroRowsRemoved.length === 0) {
        alert("No zero rows removed to undo.");
        return;
      }

      zeroRowsRemoved.sort((a, b) => b.index - a.index); // Sort in descending order to prevent index shifts

      zeroRowsRemoved.forEach(row => {
        modifiedData.splice(row.index, 0, row.data);
      });

      zeroRowsRemoved = [];
      renderTable();
    }


    // function to Log2

    function calculateLog2() {
      if (modifiedData.length === 0 || modifiedData[0].length === 0) {
        alert("Please upload a CSV file first.");
        return;
      }

      // Store the current data for undoing log2
      preLog2Data = modifiedData.map(row => [...row]);

      // Apply log2 transformation, skipping the header row
      for (let i = 1; i < modifiedData.length; i++) {
        for (let j = 0; j < modifiedData[i].length; j++) {
          const value = parseFloat(modifiedData[i][j]);
          if (!isNaN(value) && value > 0) {
            modifiedData[i][j] = Math.log2(value).toFixed(3); // Round to 3 decimal places
          } else if (!isNaN(value) && value <= 0) {
            modifiedData[i][j] = "NaN";
          }
        }
      }
      renderTable();
    }


    // Function to undo Log2

    function undoLog2() {
      if (preLog2Data.length === 0) {
        alert("No Log2 transformation to undo.");
        return;
      }
      modifiedData = preLog2Data.map(row => [...row]); // Restore the data
      preLog2Data = []; // Clear the undo data
      renderTable();
    }

    // Function to reload the table data and re-render the table
    function reloadTable() {
      if (lastLoadedCsvContent) {
        Papa.parse(lastLoadedCsvContent, {
          complete: function (results) {
            originalData = results.data;
            // Filter out rows where all cells are empty after trimming whitespace
            modifiedData = originalData.filter(row => row.some(cell => cell.trim() !== ''));
            renderTable();
            // Reset the highlighted column and row index on reload
            highlightedColumnIndex = -1;
            highlightedRowIndex = -1;
            // Remove any existing highlights from the table
            document.querySelectorAll('td, th').forEach(cell => cell.classList.remove('highlight',
              'row-highlighted', 'highlighted-header'));
          }
        });
      } else {
        alert("No data to reload. Please open a CSV file first.");
      }
    }


    // Function to highlight a column

    function highlightColumn(columnIndex) {
      // Remove any existing row highlight
      if (highlightedRowIndex !== -1) {
        const previouslyHighlightedRow = document.querySelector(
          `table tbody tr[data-row-index="${highlightedRowIndex}"]`);
        if (previouslyHighlightedRow) {
          previouslyHighlightedRow.classList.remove('row-highlighted');
        }
        highlightedRowIndex = -1;
      }
      // Remove highlight from the previously highlighted column
      if (highlightedColumnIndex !== -1) {
        const prevHeader = document.querySelector(`table thead tr th:nth-child(${highlightedColumnIndex + 1})`);
        if (prevHeader) {
          prevHeader.classList.remove('highlighted-header');
        }
        document.querySelectorAll(`table tr`).forEach(row => {
          const cell = row.cells[highlightedColumnIndex];
          if (cell) {
            cell.classList.remove('highlight');
          }
        });
      }

      // Highlight the new column
      document.querySelectorAll(`table tr`).forEach(row => {
        const cell = row.cells[columnIndex];
        if (cell) {
          cell.classList.add('highlight');
        }
      });

      // Highlight the header of the selected column
      const header = document.querySelector(`table thead tr th:nth-child(${columnIndex + 1})`);
      if (header) {
        header.classList.add('highlighted-header');
      }

      // Update the index of the highlighted column
      highlightedColumnIndex = columnIndex;
    }

    let selectedRowToDelete = -1;

    // Αποθηκεύει το ευρετήριο της τρέχουσας επιλεγμένης στήλης και γραμμής
    let highlightedColumnIndex = -1;
    let highlightedRowIndex = -1;
    let lastDeletedRow = null; // Αποθηκεύει την τελευταία διαγραμμένη γραμμή για την αναίρεση    
    let originalIndexToDelete = -1; // Νέα μεταβλητή για αποθήκευση του αρχικού ευρετηρίου    

    // Συνάρτηση για την επισήμανση μιας γραμμής
    function highlightRow(rowIndex) {
      const previouslyHighlighted = document.querySelector('table tbody tr.row-highlighted');
      if (previouslyHighlighted) {
        previouslyHighlighted.classList.remove('row-highlighted');
      }

      const selectedRow = document.querySelector(`table tbody tr[data-row-index="${rowIndex}"]`);
      if (selectedRow) {
        selectedRow.classList.add('row-highlighted');
        document.getElementById('row').value = modifiedData[rowIndex + 1][0];
        highlightedRowIndex = rowIndex;
        selectedRowToDelete = rowIndex + 1;
        originalIndexToDelete = rowIndex + 1; // Αποθηκεύουμε το ευρετήριο κατά την επιλογή
      } else {
        document.getElementById('row').value = 'Κανένα Επιλεγμένο';
        highlightedRowIndex = -1;
        selectedRowToDelete = -1;
        originalIndexToDelete = -1;
      }

      clearColumnHighlighting();
      document.getElementById('columnName').value = 'Κανένα Επιλεγμένο';
      highlightedColumnIndex = -1;
    }

    function deleteRow() {
      if (selectedRowToDelete > 0 && selectedRowToDelete < modifiedData.length) {
        lastDeletedRow = modifiedData.splice(selectedRowToDelete, 1)[0];
        selectedRowToDelete = -1;
        highlightedRowIndex = -1;
        document.getElementById('row').value = 'Κανένα Επιλεγμένο';
        renderTable();
      } else {
        alert('Παρακαλώ επιλέξτε μια έγκυρη γραμμή για διαγραφή.');
      }
    }

    function undoDeleteRow() {
      if (lastDeletedRow !== null && originalIndexToDelete !== -1) {
        modifiedData.splice(originalIndexToDelete, 0, lastDeletedRow);
        lastDeletedRow = null;
        originalIndexToDelete = -1; // Επαναφέρουμε το αρχικό ευρετήριο
        renderTable();

        // Επαναφέρουμε την επισήμανση στην γραμμή που μόλις έγινε undo (προαιρετικό)
        // Μπορείτε να αφαιρέσετε αυτό το τμήμα αν δεν το επιθυμείτε
        const rowIndexToHighlight = originalIndexToDelete - 1;
        if (rowIndexToHighlight >= 0 && rowIndexToHighlight < modifiedData.length - 1) {
          highlightRow(rowIndexToHighlight);
        }
      } else {
        alert('Δεν υπάρχει γραμμή για αναίρεση ή δεν βρέθηκε το αρχικό ευρετήριο.');
      }
    }

    function clearColumnHighlighting() {
      document.querySelectorAll('table th.highlighted-header').forEach(th => th.classList.remove('highlighted-header'));
      document.querySelectorAll('table td.highlight').forEach(td => td.classList.remove('highlight'));
    }

   function highlightColumn(columnIndex) {
  // Αφαίρεση της επισήμανσης από τον προηγούμενο header
  const previouslyHighlightedHeader = document.querySelector('table thead tr th.highlighted-header');
  if (previouslyHighlightedHeader) {
    previouslyHighlightedHeader.classList.remove('highlighted-header');
  }

  // Αφαίρεση της επισήμανσης από τα κελιά της προηγούμενης στήλης
  document.querySelectorAll('table tr').forEach(row => {
    const previouslyHighlightedCell = row.cells[highlightedColumnIndex];
    if (previouslyHighlightedCell) {
      previouslyHighlightedCell.classList.remove('highlight');
    }
  });

  // Επισήμανση του νέου header
  const header = document.querySelector(`table thead tr th:nth-child(${columnIndex + 1})`);
  if (header) {
    header.classList.add('highlighted-header');
  }

  // Επισήμανση των κελιών της νέας στήλης
  document.querySelectorAll('table tr').forEach(row => {
    const cell = row.cells[columnIndex];
    if (cell) {
      cell.classList.add('highlight');
    }
  });

  document.getElementById('columnName').value = modifiedData[0][columnIndex];
  highlightedColumnIndex = columnIndex;

  // Καθαρισμός της επισήμανσης γραμμής όταν επιλέγεται στήλη
  const previouslyHighlightedRow = document.querySelector('table tbody tr.row-highlighted');
  if (previouslyHighlightedRow) {
    previouslyHighlightedRow.classList.remove('row-highlighted');
    document.getElementById('row').value = 'Κανένα Επιλεγμένο';
    highlightedRowIndex = -1;
    selectedRowToDelete = -1;
    originalIndexToDelete = -1;
  }
}



    // Store Deleted Column (Global)
    let deletedColumns = [];


    // function Delete column

    function deleteColumn() {

      const columnName = document.getElementById('columnName').value.trim();
      if (!columnName) {
        alert("Please select a column to delete.");
        return;
      }

      const headerIndex = modifiedData[0].indexOf(columnName);
      if (headerIndex === -1) {
        alert("Column not found.");
        return;
      }

      // Store deleted column for undo functionality    

      deletedColumns.push({
        index: headerIndex,
        data: modifiedData.map(row => row[headerIndex])
      });

      // Remove the column from all rows

      modifiedData = modifiedData.map(row => row.filter((_, i) => i !== headerIndex));
      renderTable();
    }


    // function UNDO Delete column

    function undoDelete() {

      if (deletedColumns.length === 0) {
        alert("No column to restore.");
        return;
      }

      const lastDeleted = deletedColumns.pop();
      const columnIndex = lastDeleted.index;

      modifiedData.forEach((row, i) => {
        row.splice(columnIndex, 0, lastDeleted.data[i]);
      });

      renderTable();
    }

    // Functions to get table data

    function getTableData() {

      let table = document.querySelector("table");
      let headers = Array.from(table.querySelectorAll("thead th")).map(th => th.textContent.trim());
      let rows = Array.from(table.querySelectorAll("tbody tr")).map(tr =>
        Array.from(tr.querySelectorAll("td")).map(td => td.textContent.trim())
      );

      return {
        headers,
        rows
      };
    }


    function clearTable() {

      originalData = [];
      modifiedData = [];


      initializeInput('columnName', 'None Selected');
      initializeInput('row', 'None Selected');
      initializeInput('rowsize', 'No CSV Data');
      initializeInput('colsize', 'No CSV Data');
      initializeInput('yAxisMin', '0');
      initializeInput('yAxisMinBar', '0');


      // Προσθέστε έλεγχο πριν την κλήση της renderTable
      if (modifiedData && modifiedData.length === 0) {
        // Εμφάνιση ενός μηνύματος ή εκτέλεση άλλης λογικής        
        document.getElementById('csv-container').innerHTML = "<p>No data to display.</p>";
        document.getElementById('selectedFileName').value = '';
      } else {
        renderTable();
      }
    }

    function hideTable() {
      const tableContainer = document.getElementById('csv-container');
      const hideButton = document.querySelector('.hide-button');

      if (tableContainer.style.display === 'none' || window.getComputedStyle(tableContainer).display === 'none') {
        tableContainer.style.display = 'block';
        hideButton.textContent = 'Hide';

        // Scroll to the main plot after showing the table
        document.getElementById('Plot').scrollIntoView({
          behavior: 'smooth'
        });
      } else {
        tableContainer.style.display = 'none';
        hideButton.textContent = 'Show';
      }
    }

    // Set initial button text based on the initial state of the results container
    window.onload = function () {
      const tableContainer = document.getElementById('csv-container');
      const hideButton = document.querySelector('.hide-button');

      // Check the computed style to reliably get the actual display value
      if (window.getComputedStyle(tableContainer).display === 'none') {
        hideButton.textContent = 'Show';
      } else {
        hideButton.textContent = 'Hide';
      }
    };
  </Script>

  <!--Table Script End-->


  <!--Boxplot-->

  <!--BoxPlot Script Start-->

  <script>
    //Define CanvasBoxPlot
    let CanvasBoxPlot;

    // function Update Plot
    function updatePlot() {

      if (!modifiedData || modifiedData.length === 0) {
        console.error("modifiedData is undefined or empty.");
        return; // Σταματήστε την εκτέλεση της συνάρτησης
      }

      if (!modifiedData || modifiedData.length === 0 || !modifiedData[0]) {
        console.error("modifiedData is undefined, empty, or header is missing.");
        return;
      }

      const headers = modifiedData[0];
      const tableData = modifiedData.slice(1);
      const plotDiv = document.getElementById('Plot');
      plotDiv.innerHTML = ''; // Clear previous plot

      // Array to hold all box plot traces (local)
      let traces = [];

      headers.forEach((colName, colIndex) => {
        const numericColumn = tableData
          .map(row => parseFloat(row[colIndex]))
          .filter(val => !isNaN(val));

        if (numericColumn.length > 0) {
          const trace = {
            y: numericColumn,
            type: 'box',
            name: colName
          };
          traces.push(trace); // Add the trace to the array
        }
      });

      if (traces.length > 0) {
        Plotly.newPlot(plotDiv, traces); // Plot all traces at once
      } else {
        plotDiv.innerHTML = "No numerical data to plot."; // Display a message if no data
      }
    }

    // function to clear the previous Box Plot

    function clearBoxPlot() {

      const plotDiv = document.getElementById('Plot');
      plotDiv.innerHTML = ''; // Clear the Plotly plot
      const statsContainer = document.getElementById('boxplotStats');
      if (statsContainer) { // Check if the element exists
        statsContainer.innerHTML = ''; // Clear stats
      }
    }
  </script>

  <!--BoxPlot Script End-->


  <!--HeatMap-->

  <!--HeatMap Script Start-->

  <script>
    function generateHeatmap() {

      document.getElementById('Plot').innerHTML = '';

      let {
        headers,
        rows
      } = getTableData();
      if (!rows || rows.length === 0) {
        alert("Please load a CSV file and render the table first.");
        return;
      }

      let numericData = [];
      let rowLabels = [];
      let colLabels = headers.slice(1); // Exclude the first column (row labels)

      rows.forEach(row => {
        rowLabels.push(row[0]);
        let numericRow = row.slice(1).map(val => parseFloat(val));
        if (numericRow.every(val => !isNaN(val))) {
          numericData.push(numericRow);
        }
      });

      if (numericData.length === 0) {
        alert("No numeric data found for heatmap.");
        return;
      }

      let data = [{
        z: numericData,
        x: colLabels,
        y: rowLabels,
        type: 'heatmap',
        colorscale: 'Viridis' // Choose a colorscale
      }];

      let layout = {
        title: 'Heatmap',
        xaxis: {
          title: 'Columns'
        },
        yaxis: {
          title: 'Rows'
        }
      };

      Plotly.newPlot('Plot', data, layout);
    }

    function clearHeatmap() {
      document.getElementById('Plot').innerHTML = '';
    }
  </script>

  <!-- Heatmap code End-->


  <!-- BarChart-->

  <!-- BarChart Script Start-->

  <script>
    // Define myCanvasBar
    let myCanvasBar;


    // function to Clear the previous Bar Chart

    function clearBarChart() {
      document.getElementById('Plot').innerHTML = '';
    }


    // function to Generate Chart

    function generateChart() {
      clearBarChart();

      let {
        headers,
        rows
      } = getTableData();
      let columnName = document.getElementById("columnName").value.trim();
      let yAxisMinValue = parseFloat(document.getElementById("yAxisMinBar").value); // Retrieve value from text field.

      let columnIndex = headers.indexOf(columnName);
      if (columnIndex === -1) {
        alert("Column not found!");
        return;
      }

      let labels = rows.map(row => row[0]);
      let dataValues = rows.map(row => parseFloat(row[columnIndex]) || 0);

      // Create canvas dynamically
      let canvas = document.createElement("canvas");
      canvas.id = "myBarCanvas";
      canvas.height = 450;
      document.getElementById("Plot").appendChild(canvas);
      let ctx = canvas.getContext("2d");

      myCanvasBar = new Chart(ctx, {
        type: "bar",
        data: {
          labels: labels,
          datasets: [{
            label: columnName,
            data: dataValues,
            backgroundColor: "rgba(75, 192, 192, 0.6)",
            borderColor: "rgba(75, 192, 192, 1)",
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: false, // Set to false to allow custom minimum
              min: yAxisMinValue // Set the minimum value from the text field.
            }
          }
        }
      });
    }

    // function set value Bar at Zero
    initializeInput('yAxisMinBar', '0');
  </script>

  <!--BarChart Script End-->


  <!--PieChart Start-->

  <!--Pie Chart Script-->

  <script>
    // Store reference to the pie chart instance
    let pieChartInstance;

    // function to Clear previous PieChart instance if exists
    function clearPieChart() {
      document.getElementById('Plot').innerHTML = '';
    }


    // function to Generate Pie Chart
    function generatePieChart() {
      try {
        let table = document.querySelector("table");
        if (!table) {
          alert("Please upload a CSV file and render the table first.");
          return;
        }

        let {
          headers,
          rows
        } = getTableData();
        let columnName = document.getElementById("columnName").value.trim();

        let columnIndex = headers.indexOf(columnName);
        if (columnIndex === -1) {
          alert("Column not found!");
          return;
        }

        let data = {};
        for (let i = 0; i < rows.length; i++) {
          let label = rows[i][0].trim();
          let value = parseFloat(rows[i][columnIndex]);

          if (!isNaN(value)) {
            data[label] = (data[label] || 0) + value;
          }
        }

        let labels = Object.keys(data);
        let values = Object.values(data);
        let colors = labels.map(() => '#' + Math.floor(Math.random() * 16777215).toString(16));

        clearPieChart(); // Clear previous chart and div content

        // Create a canvas element dynamically
        let canvas = document.createElement('canvas');
        canvas.id = 'tempPieCanvas';
        canvas.width = 450; // Increase the width here (adjust as needed)
        document.getElementById('Plot').appendChild(canvas);

        let ctx = canvas.getContext('2d');

        pieChartInstance = new Chart(ctx, {
          type: "pie",
          data: {
            labels: labels,
            datasets: [{
              data: values,
              backgroundColor: colors,
            }]
          },
          options: {
            responsive: false, // Set responsive to false when setting explicit width
            maintainAspectRatio: false,
            height: 300,
            aspectRatio: 1, // You can adjust this to control the width/height ratio
            plugins: {
              legend: {
                position: 'right',
              },
              title: {
                display: true,
                text: `Pie Chart of ${columnName}`,
              },
            },
            layout: {
              padding: {
                top: 20,
                bottom: 20,
                left: 20,
                right: 20
              }
            },
            height: 300, // Set your desired height here (in pixels)
          },
        });

      } catch (error) {
        console.error("Error generating pie chart:", error);
        alert("An error occurred while generating the pie chart. Please check the console for details.");
      }
    }
  </script>

  <!--PyeChart Script End-->



  <!--Line Chart-->

  <!--Line Chart Script Start-->

  <script>
    // Line Chart Functions
    let myLineChartInstance;

    function clearLineChart() {
      document.getElementById('Plot').innerHTML = '';
    }

    function generateLineChart() {

      clearLineChart();

      let {
        headers,
        rows
      } = getTableData();
      let columnName = document.getElementById("columnName").value.trim();

      let columnIndex = headers.indexOf(columnName);
      if (columnIndex === -1) {
        alert("Column not found!");
        return;
      }

      let labels = rows.map(row => row[0]);
      let dataValues = rows.map(row => parseFloat(row[columnIndex]) || 0);

      let canvas = document.createElement("canvas");
      canvas.id = "myLineCanvas";
      canvas.height = 450;
      document.getElementById("Plot").appendChild(canvas);

      let ctx = canvas.getContext("2d");

      let yAxisMinValue = parseFloat(document.getElementById("yAxisMin").value) || 0;

      myLineChartInstance = new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [{
            label: columnName,
            data: dataValues,
            borderColor: "blue",
            tension: 0.1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: false, // Ensure that the min value is used
              min: yAxisMinValue
            }
          }
        }
      });
    }

    // function set value Line at Zero
    initializeInput('yAxisMin', '0');
  </script>

  <!--Line Chart Script End-->



  <!--Scroll to main Plot-->

  <script>
    function scrollToMainPlot() {
      const mainPlot = document.getElementById('Plot');
      if (mainPlot) {
        mainPlot.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }

    }
  </script>



  <!--Windows-->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let mainWindow = null;
      let combineWindow = null;
      let createWindow = null;
      let scheduleWindow = null;
      
      document.getElementById('mainTabLink').addEventListener('click', function (event) {
        event.preventDefault(); // Prevent default link behavior

        if (mainWindow && !mainWindow.closed) {
          mainWindow.focus(); // Focus on the existing window
        } else {
          mainWindow = window.open('main.html', '_blank'); // Open a new window
        }
      });

      document.getElementById('combineTabLink').addEventListener('click', function (event) {
        event.preventDefault(); // Prevent default link behavior

        if (combineWindow && !combineWindow.closed) {
          combineWindow.focus(); // Focus on the existing window
        } else {
          combineWindow = window.open('combine.html', '_blank'); // Open a new window
        }
      });

      document.getElementById('createTabLink').addEventListener('click', function (event) {
        event.preventDefault(); // Prevent default link behavior

        if (createWindow && !createWindow.closed) {
          createWindow.focus(); // Focus on the existing window
        } else {
          createWindow = window.open('create.html', '_blank'); // Open a new window
        }
      });

      document.getElementById('scheduleTabLink').addEventListener('click', function (event) {
        event.preventDefault(); // Prevent default link behavior

        if (scheduleWindow && !scheduleWindow.closed) {
          scheduleWindow.focus(); // Focus on the existing window
        } else {
          scheduleWindow = window.open('schedule.html', '_blank'); // Open a new window
        }
      });     
    });
  </script>

  <br>
  <!-- Footer -->
  <footer class="footer">
    <p>© 2025 Dashboard</p>
  </footer>

</body>

</html>